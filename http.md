1. Studied from (https://www.ntu.edu.sg/home/ehchua/programming/webprogramming/HTTP_Basics.html)
  - Hyper Text Transfer Protocol
  - Protocol for exchanging data on the web between client and server
  - It is an asymmetric request-response client-server Protocol. This means
    - There many-to-one relation between client to server
    - The server is in passive mode and the client (mostly) initiates the workflow.
  - It is a stateless protocol - each request/response is unaware of its predecessors
  - State management or session context are maintained via cookies
  - It typically runs over TCP/IP.
  - There are currently 2 versions 1.0 and 1.1.

2. General flow:
  - User enters an URL on the browser
  - Browser sends request message to the server
  - Server sends back a response message
    - When this request message reaches the server, the server can take either one of these actions:
    - The server interprets the request received, maps the request into a file under the server's document directory, and returns the file requested to the client.
    - The server interprets the request received, maps the request into a program kept in the server, executes the program, and returns the output of the program to the client.
    - The request cannot be satisfied, the server returns an error message.
  - Browser displays the formatted content for the user

3. URL - Uniform Resource Locator
  - `protocol://domain:port/path-and-file-name` e.g. `http://127.0.0.1:3000/index.html`
  - `Port 80` is the default port number for HTTP.

4. Request Message from the browser
 - structure :

        | Content  | Format |
        | ------------- | ------------- |
        | Request Line  | `request-method-name request-URI HTTP version` |
        | Request Header| Host:   |
        | Accept:  |
        | Accept-Language:  |
        | etc.  |
        | blank line |
        | Request Body |

   e.g `GET /docs/index.html HTTP/1.1
        Host: www.nowhere123.com
        Accept: image/gif, image/jpeg, */*
        Accept-Language: en-us
        Accept-Encoding: gzip, deflate
        User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
        (blank line)`
5. Response Message from server
  - Structure

```
  HTTP/1.1 200 OK
  Accept-Ranges: bytes
  Cache-Control: public, max-age=0
  Last-Modified: Thu, 02 Jan 2020 15:49:24 GMT
  ETag: W/"138-16f66f27891"
  Content-Type: text/html; charset=UTF-8
  Content-Length: 1493
  Date: Thu, 02 Jan 2020 15:55:15 GMT
  Connection: close

  <!DOCTYPE html>
  <html lang="en" dir="ltr">
    <head>
      <meta charset="utf-8">
      <title>My first html</title>
      <link rel="stylesheet" type="text/css" href="styles.css"/>
    </head>
    <body>
      <h1 name="h1"> This is hello</h1>
      <p>This is cool.Trying live reload for the first time</p>
  </body>
  </html>
```
6. Request Methods HTTP protocol defines a set of request methods. A client can use one of these request methods to send a request message to an HTTP server. The methods are:
  - __GET__: A client can use the GET request to get a web resource from the server.
  - HEAD: A client can use the HEAD request to get the header that a GET request would have obtained. Since the header contains the last-modified date of the data, this can be used to check against the local cache copy.
  - __POST__: Used to post data up to the web server.
  - DELETE: Ask the server to delete the data.
  - TRACE: Ask the server to return a diagnostic trace of the actions it takes.
  - OPTIONS: Ask the server to return the list of request methods it supports.
  - CONNECT: Used to tell a proxy to make a connection to another host and simply reply the content, without attempting to parse or cache it. This is often used to make SSL connection through the proxy.

7. Response Status Code - The first line of the response message (i.e., the status line) contains the response status code, which is generated by the server to indicate the outcome of the request.
  - The status code is a 3-digit number:
  - PUT: Ask the server to store the data.
  - 1xx (Informational): Request received, server is continuing the process.
  - 2xx (Success): The request was successfully received, understood, accepted and serviced.
  - 3xx (Redirection): Further action must be taken in order to complete the request.
  - 4xx (Client Error): The request contains bad syntax or cannot be understood.
  - 5xx (Server Error): The server failed to fulfill an apparently valid request.
  - Some commonly encountered status codes are:
    - 100 Continue: The server received the request and in the process of giving the response.
    - __200 OK__: The request is fulfilled.
    - 301 Move Permanently: The resource requested for has been permanently moved to a new location. The URL of the new location is given in the response header called Location. The client should issue a new request to the new location. Application should update all references to this new location.
    - 302 Found & Redirect (or Move Temporarily): Same as 301, but the new location is temporarily in nature. The client should issue a new request, but applications need not update the references.
    - 304 Not Modified: In response to the If-Modified-Since conditional GET request, the server notifies that the resource requested has not been modified.
    - __400 Bad Request__: Server could not interpret or understand the request, probably syntax error in the request message.
    - 401 Authentication Required: The requested resource is protected, and require client’s credential (username/password). The client should re-submit the request with his credential (username/password).
    - __403 Forbidden__: Server refuses to supply the resource, regardless of identity of client.
    - __404 Not Found__: The requested resource cannot be found in the server.
    - 405 Method Not Allowed: The request method used, e.g., POST, PUT, DELETE, is a valid method. However, the server does not allow that method for the resource requested.
    - 408 Request Timeout:
    - 414 Request URI too Large:
    - __500 Internal Server Error__: Server is confused, often caused by an error in the server-side program responding to the request.
    - 501 Method Not Implemented: The request method used is invalid (could be caused by a typing error, e.g., "GET" misspell as "Get").
    - 502 Bad Gateway: Proxy or Gateway indicates that it receives a bad response from the upstream server.
    - 503 Service Unavailable: Server cannot response due to overloading or maintenance.

8. Authentication workflow
    1. User enters an URL on the browser
    2. Browser sends HTTP GET request for a page within the __protected realm__ to the server
    3. The server responds with a __HTTP/1.1 401 Unauthorized__ with __WWW-Authenticate: Basic realm="<username>"__
    4. The browser prompts the user for username and password
    5. Browser send HTTP GET with __Authorization: Basic d2lyZXNoYXJrLXN0dWRlbnRzOm5ldHdvcms=\r\n__
    6. The server Base64 decodes and verifies the credential and responds with the page

9. HTTP Conditional Get workflow
  1. User enters an URL on the browser
  2. Browser sends HTTP GET request for the page
  3. The server responds with a __HTTP/1.1 200 OK__ with __Last-Modified__ and __ETag__
        ```
      Hypertext Transfer Protocol
          HTTP/1.1 200 OK\r\n
          Date: Sun, 06 Dec 2020 14:53:12 GMT\r\n
          Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.12 mod_perl/2.0.11 Perl/v5.16.3\r\n
          Last-Modified: Sun, 06 Dec 2020 06:59:03 GMT\r\n
          ETag: "173-5b5c63eaae181"\r\n
          Accept-Ranges: bytes\r\n
          Content-Length: 371\r\n
          Keep-Alive: timeout=5, max=100\r\n
          Connection: Keep-Alive\r\n
          Content-Type: text/html; charset=UTF-8\r\n
          \r\n
          [HTTP response 1/1]
          [Time since request: 0.074088756 seconds]
          [Request in frame: 5]
          [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
          File Data: 371 bytes
      Line-based text data: text/html (10 lines)
          \n
          <html>\n
          \n
          Congratulations again!  Now you've downloaded the file lab2-2.html. <br>\n
          This file's last modification date will not change.  <p>\n
          Thus  if you download this multiple times on your browser, a complete copy <br>\n
          will only be sent once by the server due to the inclusion of the IN-MODIFIED-SINCE<br>\n
          field in your browser's HTTP GET request to the server.\n
          \n
          </html>\n
      ```
  4. On refreshing the page the browser sends the GET request with __If-None-Match__ and __If-Modified-Since__
      ```
        Hypertext Transfer Protocol
            GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1\r\n
            Host: gaia.cs.umass.edu\r\n
            Connection: keep-alive\r\n
            Cache-Control: max-age=0\r\n
            DNT: 1\r\n
            Upgrade-Insecure-Requests: 1\r\n
            User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36\r\n
            Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
            Accept-Encoding: gzip, deflate\r\n
            Accept-Language: en-US,en;q=0.9\r\n
            If-None-Match: "173-5b5c63eaae181"\r\n
            If-Modified-Since: Sun, 06 Dec 2020 06:59:03 GMT\r\n
            \r\n
            [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
            [HTTP request 1/1]
            [Response in frame: 21]
      ```
  5. Server responds with __304 Not Modified__ and does NOT re-send the page.
      ```
      Hypertext Transfer Protocol
          HTTP/1.1 304 Not Modified\r\n
          Date: Sun, 06 Dec 2020 14:53:19 GMT\r\n
          Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.12 mod_perl/2.0.11 Perl/v5.16.3\r\n
          Connection: Keep-Alive\r\n
          Keep-Alive: timeout=5, max=100\r\n
          ETag: "173-5b5c63eaae181"\r\n
          \r\n
          [HTTP response 1/1]
          [Time since request: 0.071557096 seconds]
          [Request in frame: 16]
          [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
      ```
10. Long Page Request Workflow ( when the response is >1500 bytes usually)
  1. User enters an URL on the browser
  2. Browser sends HTTP GET request for the page
  3. The server responds with a __HTTP/1.1 200 OK__
  4. TCP segments the data and reassembles the segments

    ```
      [4 Reassembled TCP Segments (4861 bytes): #50(1440), #52(1440), #54(1440), #55(541)]
          [Frame: 50, payload: 0-1439 (1440 bytes)]
          [Frame: 52, payload: 1440-2879 (1440 bytes)]
          [Frame: 54, payload: 2880-4319 (1440 bytes)]
          [Frame: 55, payload: 4320-4860 (541 bytes)]
          [Segment count: 4]
          [Reassembled TCP length: 4861]
          [Reassembled TCP Data: 485454502f312e3120323030204f4b0d0a446174653a2053…]
    ```
11. Request with embedded resources workflow
  1. Same flow for the main Page
  2. Browser __sequentially__ sends request for the each of the embedded resources

Glossary
1. DNT - Do Not Track : A web browser setting that requests that the web application disable tracking of an individual user (0 - Yes | 1 - No | Null - No preference)
  - No consensus on how DNT needs to be inpterpreted and hence most sites do not change their behavior
2. ETag - Entity Tag :  response header provides a mechanism to cache unchanged resources. It's value is an identifier which represents a specific version of the resource.
